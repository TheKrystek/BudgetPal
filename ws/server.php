<?php
				require_once 'mainClass.php';
				require_once 'config.php';
				require_once 'lang/english.php';
				
				$json = true;
				define('USE_JSON',true);
				define('PRETTY_PRINT',true);
				
				if ($json)
					if (isset($_GET['pp']))
						require_once 'formats/json_pp.php';
					else
						require_once 'formats/json.php';
				else
					require_once 'formats/default.php';

				$ws = new mainClass($user,$pass,$host,$base);
				$ws->Connect();if (isset($_GET['a'])){switch($_GET['a']){case 'register' : {if (!$ws->IsLogged()){if (isset($_GET['login']) && isset($_GET['password']) && isset($_GET['email'])){show($ws->Register($_GET['login'], $_GET['password'], $_GET['email']));}else{show(status('WRONG_PARAMETERS'));}}else{show(status('MUST_BE_LOGGED_OUT'));}break;}case 'login' : {if (!$ws->IsLogged()){if (isset($_GET['user']) && isset($_GET['password'])){show($ws->Login($_GET['user'], $_GET['password']));}else{show(status('WRONG_PARAMETERS'));}}else{show(status('MUST_BE_LOGGED_OUT'));}break;}case 'logout' : {if ($ws->IsLogged()){show($ws->Logout());}else{show(status('MUST_BE_LOGGED_IN'));}break;}case 'getbudgets' : {if ($ws->IsLogged()){show($ws->GetBudgets());}else{show(status('MUST_BE_LOGGED_IN'));}break;}case 'addbudget' : {if ($ws->IsLogged()){if (isset($_GET['name']) && isset($_GET['description'])){show($ws->AddBudget($_GET['name'], $_GET['description']));}else{show(status('WRONG_PARAMETERS'));}}else{show(status('MUST_BE_LOGGED_IN'));}break;}case 'updatebudget' : {if ($ws->IsLogged()){if (isset($_GET['budgetId']) && isset($_GET['name']) && isset($_GET['description'])){show($ws->UpdateBudget($_GET['budgetId'], $_GET['name'], $_GET['description']));}else{show(status('WRONG_PARAMETERS'));}}else{show(status('MUST_BE_LOGGED_IN'));}break;}case 'deletebudget' : {if ($ws->IsLogged()){if (isset($_GET['budgetId'])){show($ws->DeleteBudget($_GET['budgetId']));}else{show(status('WRONG_PARAMETERS'));}}else{show(status('MUST_BE_LOGGED_IN'));}break;}case 'getproductcategories' : {if ($ws->IsLogged()){show($ws->GetProductCategories());}else{show(status('MUST_BE_LOGGED_IN'));}break;}case 'addproductcategory' : {if ($ws->IsLogged()){if (isset($_GET['name'])){show($ws->AddProductCategory($_GET['name']));}else{show(status('WRONG_PARAMETERS'));}}else{show(status('MUST_BE_LOGGED_IN'));}break;}case 'getincomecategories' : {if ($ws->IsLogged()){show($ws->GetIncomeCategories());}else{show(status('MUST_BE_LOGGED_IN'));}break;}case 'addincomecategory' : {if ($ws->IsLogged()){if (isset($_GET['name'])){show($ws->AddIncomeCategory($_GET['name']));}else{show(status('WRONG_PARAMETERS'));}}else{show(status('MUST_BE_LOGGED_IN'));}break;}case 'addproduct' : {if ($ws->IsLogged()){if (isset($_GET['prodact_cat']) && isset($_GET['name'])){show($ws->AddProduct($_GET['prodact_cat'], $_GET['name']));}else{show(status('WRONG_PARAMETERS'));}}else{show(status('MUST_BE_LOGGED_IN'));}break;}case 'getproducts' : {if ($ws->IsLogged()){show($ws->GetProducts());}else{show(status('MUST_BE_LOGGED_IN'));}break;}case 'getexpenses' : {if ($ws->IsLogged()){if (isset($_GET['budgetId'])){show($ws->GetExpenses($_GET['budgetId']));}else{show(status('WRONG_PARAMETERS'));}}else{show(status('MUST_BE_LOGGED_IN'));}break;}case 'addexpense' : {if ($ws->IsLogged()){if (isset($_GET['budgetId']) && isset($_GET['name']) && isset($_GET['amount'])){show($ws->AddExpense($_GET['budgetId'], $_GET['name'], $_GET['amount'], $_GET['purchaseId']));}else{show(status('WRONG_PARAMETERS'));}}else{show(status('MUST_BE_LOGGED_IN'));}break;}case 'updateexpense' : {if ($ws->IsLogged()){if (isset($_GET['expenseId']) && isset($_GET['name']) && isset($_GET['amount'])){show($ws->UpdateExpense($_GET['expenseId'], $_GET['name'], $_GET['amount'], $_GET['purchaseId']));}else{show(status('WRONG_PARAMETERS'));}}else{show(status('MUST_BE_LOGGED_IN'));}break;}case 'deleteexpense' : {if ($ws->IsLogged()){if (isset($_GET['expenseId'])){show($ws->DeleteExpense($_GET['expenseId']));}else{show(status('WRONG_PARAMETERS'));}}else{show(status('MUST_BE_LOGGED_IN'));}break;}case 'getincomes' : {if ($ws->IsLogged()){if (isset($_GET['budgetId'])){show($ws->GetIncomes($_GET['budgetId']));}else{show(status('WRONG_PARAMETERS'));}}else{show(status('MUST_BE_LOGGED_IN'));}break;}case 'addincome' : {if ($ws->IsLogged()){if (isset($_GET['budgetId']) && isset($_GET['name']) && isset($_GET['amount']) && isset($_GET['incomeCategory'])){show($ws->AddIncome($_GET['budgetId'], $_GET['name'], $_GET['amount'], $_GET['incomeCategory']));}else{show(status('WRONG_PARAMETERS'));}}else{show(status('MUST_BE_LOGGED_IN'));}break;}case 'getrecentactivities' : {if ($ws->IsLogged()){if (isset($_GET['budgetId'])){show($ws->GetRecentActivities($_GET['budgetId'], $_GET['order'], $_GET['limit']));}else{show(status('WRONG_PARAMETERS'));}}else{show(status('MUST_BE_LOGGED_IN'));}break;}case 'getincomessum' : {if ($ws->IsLogged()){if (isset($_GET['budgetId'])){show($ws->GetIncomesSum($_GET['budgetId']));}else{show(status('WRONG_PARAMETERS'));}}else{show(status('MUST_BE_LOGGED_IN'));}break;}case 'getexpensessum' : {if ($ws->IsLogged()){if (isset($_GET['budgetId'])){show($ws->GetExpensesSum($_GET['budgetId']));}else{show(status('WRONG_PARAMETERS'));}}else{show(status('MUST_BE_LOGGED_IN'));}break;}case 'getbudgetbilans' : {if ($ws->IsLogged()){if (isset($_GET['budgetId'])){show($ws->GetBudgetBilans($_GET['budgetId']));}else{show(status('WRONG_PARAMETERS'));}}else{show(status('MUST_BE_LOGGED_IN'));}break;}default: show(status('NOT_SUPPORTED'));}}$ws->Close();?>